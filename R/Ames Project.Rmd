---
title: "Ames Project"
author: "Daniel Immediato"
date: "2024-04-20"
output: html_document
---

```{r}
#libraries
library(tidyverse)
library(dplyr)
library(ggplot2)
library(randomForest)
library(varImp)
#library(caret)
library(reticulate)
library(lubridate)
use_python("C:/Users/immed/Programming/Anaconda/python.exe",required = TRUE)
pd <- import("pandas")
setwd("~/NYCDSA/Third Project/ML_Ames_Housing/R")
Ames_Housing = pd$read_pickle("C:/Users/immed/Documents/NYCDSA/Third Project/ML_Ames_Housing/Python/housing_numeric.pkl")
Ames_Housing$YrSold <- as.Date(Ames_Housing$YrSold, format = "%Y")
Ames_Housing$YrSold <- year(Ames_Housing$YrSold)
Ames_Housing$GarageYrBlt <- as.Date(Ames_Housing$GarageYrBlt, format = "%Y")
Ames_Housing$GarageYrBlt <- year(Ames_Housing$GarageYrBlt)
Ames_Housing$MoSold <- as.Date(Ames_Housing$MoSold, format = "%Y")
Ames_Housing$MoSold <- year(Ames_Housing$MoSold)
Ames_Housing$YearBuilt <- as.Date(Ames_Housing$YearBuilt, format = "%Y")
Ames_Housing$YearBuilt <- year(Ames_Housing$YearBuilt)
Ames_Housing$YearRemodAdd <- as.Date(Ames_Housing$YearRemodAdd, format = "%Y")
Ames_Housing$YearRemodAdd <- year(Ames_Housing$YearRemodAdd)
colnames(Ames_Housing)[colnames(Ames_Housing) == '1stFlrSF'] = 'FirstFlrSF'
colnames(Ames_Housing)[colnames(Ames_Housing) == '2ndFlrSF'] = 'SecondFlrSF'
colnames(Ames_Housing)[colnames(Ames_Housing) == '3SsnPorch'] = 'ThreeSsnPorch'
Ames_Housing
```

```{r}
Ames_Housing <- Ames_Housing[!Ames_Housing$PID == "908154205",]
Ames_Housing <- Ames_Housing[!Ames_Housing$PID == "528351010",]
Ames_Housing <- Ames_Housing[!Ames_Housing$PID == "909176150",]
Ames_Housing <- Ames_Housing[!Ames_Housing$PID == "533350090",]
Ames_Housing <- Ames_Housing[!Ames_Housing$PID == "905476230",]
lm1 = lm(SalePrice ~ . -PID -YrSold -GarageYrBlt -TotalBsmtSF -LowQualFinSF -MoSold -YearBuilt -YearRemodAdd, data = Ames_Housing)
summary(lm1)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
#library(car)
#Ames_Housing$Resid<-resid(lm1)
#o <- order(Ames_Housing$Resid^2, decreasing=T)

#Ames_Housing[o[1:5],]
plot(lm1)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r}
#influencePlot(lm1)
```


```{r}
AIC(lm1)
BIC(lm1)
summary(lm1)$adj.r.squared
```
```{r}
regressor <- randomForest(SalePrice ~ . -PID -YrSold -GarageYrBlt -TotalBsmtSF -LowQualFinSF -MoSold -YearBuilt -YearRemodAdd, data = Ames_Housing, importance=TRUE)
res = importance(regressor)
res = res[order(res[,1],decreasing=TRUE),drop=FALSE,]
res
```

